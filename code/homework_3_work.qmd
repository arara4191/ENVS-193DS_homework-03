---
title: "Homework 3 work"
author: "Arantza Lira"
format: html
editor: visual
---
link to Github: https://github.com/arara4191/ENVS-193DS_homework-03.git 

```{r-loading packages}
#loading in necessary packages

library("tidyverse")
library("here")
library("janitor")
library("gt")

```

```{r reading in data}
#read in my biking speed data
#use here package to ensure reproducibility of the code

bike_data <- read_csv(here("data", "Biking_Speed_Data.csv"))


```

#Problem 1. Personal Data
##a. 

I can group my biking trips into trips where I listened to fast or slow music and find the average biking speed (mph) of each group. Since fast music usually gives me more energy, I think this might translate to biking faster when the music is faster.

##b. 

```{r}
#cleaning bike data column names
bike_data_clean <- clean_names(bike_data)

#creating a separate data frame to store data exploration info
bike_data_mean_exp <- bike_data_clean %>%
  group_by(music) %>% #creating groups based on slow/fast music
  summarize(mean_mph = mean(average_biking_speed_mph)) #summarizing mean speed of each group




#creating boxplot to visualize average biking speed based on music
ggplot(data = bike_data_clean,#creating base plot with cleaned data    
       aes(x = music,             
           y = average_biking_speed_mph,            
           fill = music)) +          
  geom_boxplot() +  #creates a box plot
  geom_jitter(height = 0,#prevents jitter from moving points along vertically
              width = 0.2) + #narrows spread of jitter along x-axis
  labs( x = "Music",
        y = "Average Biking Speed (mph)",
        title = "Relationship Between Music Type and Biking Speed (mph)") +
  geom_point() +
  scale_fill_manual(values = c("fast" = "red", 
                                "slow" = "pink"))+ # manually changing colors
  theme(legend.position = "none") # removes legend



```

##c. 
```{r}
# using count function to see the number of values for each type of music
count(bike_data_clean,music)# (data frame, column)
```

**Figure 1.Faster recorded biking speeds associated with fast music** Data of biking rides collected from the Strava app using miles per hour. Points represent average biking speed of each bike ride with fast(n = 18) or slow music(n = 12). Colors represent music types in the boxplots(fast = red, slow = pink). Fast music has higher recorded average biking speeds with a higher mean, but its distribution still overlaps with the slow biking speed distribution. 

##d. 

```{r-summary dataframe and gt table}

#creating the data frame for the gt table
bike_data_summary <- bike_data_clean %>%
  group_by(music) %>% #creating groups based on slow/fast music
  summarize(observations = n(), #counting the number of observations per group
            average_speed = round(mean(average_biking_speed_mph), digits = 1),#summarizing mean speed of each group
            max_avg_speed = max(average_biking_speed_mph),# fidning max speed
            min_avg_speed = min(average_biking_speed_mph)) #finding min speed

#creating gt table 
gt_bike_data_summary <- gt(bike_data_summary) %>% #creating dataframe to use for gt table display
  cols_label(  # renaming column names in table to remove underscores
    music = "Music",
    observations = "Observations",
    average_speed = "Average Speed (mph)",
    max_avg_speed = "Maximum Average Speed(mph)",
    min_avg_speed = "Minimum Average Speed(mph)"
  ) %>%
  tab_header(title = "Bike Speed Summary Statistics")
  # adding title
  
gt_bike_data_summary # displaying table



```







